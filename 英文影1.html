<html>
  <head>
    <title>Chat Room</title>
  </head>
  <body>
    <div id="chat-area">
      <div id="chat-history">
        <!-- messages will be displayed here -->
      </div>
      <div id="chat-input">
        <input type="text" id="chat-name" placeholder="Your name" value="<?php echo $_SESSION['username']; ?>">
        <input type="text" id="chat-message" placeholder="Type your message here">
        <button id="chat-submit">Submit</button>
        <button id="chat-clear">Clear Chat</button>
        <input type="password" id="chat-password" placeholder="Password to clear chat">
      </div>
    </div>

    <script>
      const chatName = document.getElementById("chat-name");
      const chatMessage = document.getElementById("chat-message");
      const chatSubmit = document.getElementById("chat-submit");
      const chatClear = document.getElementById("chat-clear");
      const chatPassword = document.getElementById("chat-password");
      const chatHistory = document.getElementById("chat-history");

      // Load previous messages from local storage
      chatHistory.innerHTML = localStorage.getItem("chatHistory") || "";

      chatSubmit.addEventListener("click", function() {
        const name = chatName.value;
        const message = chatMessage.value;
        const newMessage = document.createElement("p");
        newMessage.innerHTML = `${name}: ${message}`;
        chatHistory.appendChild(newMessage);
        chatMessage.value = "";

        // Add delete button to each message
        const deleteButton = document.createElement("button");
        deleteButton.innerHTML = "Delete";
        newMessage.appendChild(deleteButton);

        deleteButton.addEventListener("click", function() {
          // Check if password is correct
          const password = prompt("Enter password to delete message");
          if (password === "secret") {
            chatHistory.removeChild(newMessage);

            // Save updated chat history to local storage
            localStorage.setItem("chatHistory", chatHistory.innerHTML);
          } else {
            alert("Incorrect password!");
          }
        });

        // Save chat history to local storage
        localStorage.setItem("chatHistory", chatHistory.innerHTML);
      });

      chatClear.addEventListener("click", function() {
        // Check if password is correct
        const password = chatPassword.value;
        if (password === "secret") {
          chatHistory.innerHTML = "";

          // Save empty chat history to local storage
          localStorage.setItem("chatHistory", "");
        } else {
          alert("Incorrect password!");
        }
      });
    </script>
  </body>
</html>
